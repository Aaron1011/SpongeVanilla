apply plugin: 'java'
apply plugin: 'application'
apply plugin: 'eclipse'
apply plugin: 'idea'

mainClassName = "org.granitemc.granite.Main"

sourceCompatibility = 1.7
version = "1.8-SNAPSHOT-$System.env.BUILD_NUMBER"

repositories {
    mavenCentral()
}

dependencies {
    compile 'org.javassist:javassist:3.18.2-GA'
    compile 'com.typesafe:config:1.2.1'
    compile 'com.google.guava:guava:18.0'
    testCompile 'junit:junit:4.11'
}

task fatJar(type: Jar) {
    manifest {
        attributes 'Main-Class': mainClassName
    }
	classifier = 'all'
    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
    with jar
}

// add a source jar
task sourceJar(type: Jar) {
	from sourceSets.main.allSource
	classifier = 'sources'
}

// add a javadoc jar
task javadocJar(type: Jar, dependsOn: javadoc) {
	classifier = 'javadoc'
	from 'build/docs/javadoc'
}